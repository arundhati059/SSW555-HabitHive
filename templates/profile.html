{% extends "base_dashboard.html" %}

{% block title %}Profile - HabitHive{% endblock %}

{% block content %}
<div class="dashboard-main">
    <div class="profile-page-content">
    <div class="profile-container">
        <!-- Profile Header -->
        <div class="profile-header">
            <div class="profile-avatar-section">
                <div class="profile-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <button class="btn-change-avatar">
                    <i class="fas fa-camera"></i>
                    Change Photo
                </button>
            </div>
            <div class="profile-info">
                <h2 class="profile-name">John Smith</h2>
                <p class="profile-email">john.smith@email.com</p>
                <div class="profile-stats">
                    <div class="stat">
                        <span class="stat-number">47</span>
                        <span class="stat-label">Days Active</span>
                    </div>
                    <div class="stat">
                        <span class="stat-number">23</span>
                        <span class="stat-label">Active Habits</span>
                    </div>
                    <div class="stat">
                        <span class="stat-number">87%</span>
                        <span class="stat-label">Success Rate</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Profile Settings -->
        <div class="profile-settings-section">
            <div class="section-header">
                <h3><i class="fas fa-cog"></i> Profile Settings</h3>
            </div>
            <form id="profileForm" class="profile-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstName">First Name</label>
                        <input type="text" id="firstName" name="firstName" class="form-control" value="John">
                    </div>
                    <div class="form-group">
                        <label for="lastName">Last Name</label>
                        <input type="text" id="lastName" name="lastName" class="form-control" value="Smith">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" class="form-control" value="john.smith@email.com">
                    </div>
                    <div class="form-group">
                        <label for="timezone">Timezone</label>
                        <select id="timezone" name="timezone" class="form-control">
                            <option value="UTC-5">Eastern Time (UTC-5)</option>
                            <option value="UTC-6">Central Time (UTC-6)</option>
                            <option value="UTC-7">Mountain Time (UTC-7)</option>
                            <option value="UTC-8" selected>Pacific Time (UTC-8)</option>
                            <option value="UTC">UTC</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="dateFormat">Date Format</label>
                        <select id="dateFormat" name="dateFormat" class="form-control">
                            <option value="MM/DD/YYYY" selected>MM/DD/YYYY</option>
                            <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                            <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="language">Language</label>
                        <select id="language" name="language" class="form-control">
                            <option value="en" selected>English</option>
                            <option value="es">Spanish</option>
                            <option value="fr">French</option>
                            <option value="de">German</option>
                        </select>
                    </div>
                </div>
                
                <button type="submit" class="btn-save-profile">
                    <i class="fas fa-save"></i>
                    Save Changes
                </button>
            </form>
        </div>
        
        <!-- Notification Settings -->
        <div class="notification-settings-section">
            <div class="section-header">
                <h3><i class="fas fa-bell"></i> Notification Preferences</h3>
            </div>
            <div class="notification-form">
                <div class="notification-group">
                    <div class="notification-item">
                        <div class="notification-info">
                            <h4>Email Notifications</h4>
                            <p>Receive email reminders and updates about your habits</p>
                        </div>
                        <div class="toggle-switch">
                            <input type="checkbox" id="emailNotifications" checked>
                            <label for="emailNotifications" class="toggle-label"></label>
                        </div>
                    </div>
                    
                    <div class="notification-item">
                        <div class="notification-info">
                            <h4>Push Notifications</h4>
                            <p>Get browser notifications for habit reminders</p>
                        </div>
                        <div class="toggle-switch">
                            <input type="checkbox" id="pushNotifications" checked>
                            <label for="pushNotifications" class="toggle-label"></label>
                        </div>
                    </div>
                    
                    <div class="notification-item">
                        <div class="notification-info">
                            <h4>Weekly Summary</h4>
                            <p>Receive a weekly summary of your progress</p>
                        </div>
                        <div class="toggle-switch">
                            <input type="checkbox" id="weeklySummary" checked>
                            <label for="weeklySummary" class="toggle-label"></label>
                        </div>
                    </div>
                    
                    <div class="notification-item">
                        <div class="notification-info">
                            <h4>Friend Activity</h4>
                            <p>Get notified when friends achieve milestones</p>
                        </div>
                        <div class="toggle-switch">
                            <input type="checkbox" id="friendActivity">
                            <label for="friendActivity" class="toggle-label"></label>
                        </div>
                    </div>
                    
                    <div class="notification-item">
                        <div class="notification-info">
                            <h4>Streak Reminders</h4>
                            <p>Get reminders to maintain your streaks</p>
                        </div>
                        <div class="toggle-switch">
                            <input type="checkbox" id="streakReminders" checked>
                            <label for="streakReminders" class="toggle-label"></label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Privacy Settings -->
        <div class="privacy-settings-section">
            <div class="section-header">
                <h3><i class="fas fa-shield-alt"></i> Privacy & Security</h3>
            </div>
            <div class="privacy-form">
                <div class="privacy-group">
                    <div class="privacy-item">
                        <div class="privacy-info">
                            <h4>Profile Visibility</h4>
                            <p>Control who can see your profile and progress</p>
                        </div>
                        <select class="privacy-select">
                            <option value="public">Public</option>
                            <option value="friends" selected>Friends Only</option>
                            <option value="private">Private</option>
                        </select>
                    </div>
                    
                    <div class="privacy-item">
                        <div class="privacy-info">
                            <h4>Habit Progress</h4>
                            <p>Who can see your habit progress and statistics</p>
                        </div>
                        <select class="privacy-select">
                            <option value="public">Public</option>
                            <option value="friends" selected>Friends Only</option>
                            <option value="private">Private</option>
                        </select>
                    </div>
                    
                    <div class="privacy-item">
                        <div class="privacy-info">
                            <h4>Activity Feed</h4>
                            <p>Control visibility of your activities in friends' feeds</p>
                        </div>
                        <select class="privacy-select">
                            <option value="public">Public</option>
                            <option value="friends" selected>Friends Only</option>
                            <option value="private">Private</option>
                        </select>
                    </div>
                </div>
                
                <div class="security-actions">
                    <button class="btn-change-password">
                        <i class="fas fa-key"></i>
                        Change Password
                    </button>
                    <button class="btn-export-data">
                        <i class="fas fa-download"></i>
                        Export My Data
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Account Actions -->
        <div class="account-actions-section">
            <div class="section-header">
                <h3><i class="fas fa-user-cog"></i> Account Actions</h3>
            </div>
            <div class="actions-grid">
                <button class="btn-action" id="resetProgress">
                    <i class="fas fa-undo"></i>
                    <span>Reset Progress</span>
                    <small>Clear all habit data and start fresh</small>
                </button>
                
                <button class="btn-action" id="deactivateAccount">
                    <i class="fas fa-user-minus"></i>
                    <span>Deactivate Account</span>
                    <small>Temporarily disable your account</small>
                </button>
                
                <button class="btn-action danger" id="deleteAccount">
                    <i class="fas fa-trash-alt"></i>
                    <span>Delete Account</span>
                    <small>Permanently delete your account and all data</small>
                </button>
            </div>
        </div>
        
        <!-- Achievement Showcase -->
        <div class="achievements-section">
            <div class="section-header">
                <h3><i class="fas fa-trophy"></i> Achievements</h3>
            </div>
            <div class="achievements-grid">
                <div class="achievement-card earned">
                    <div class="achievement-icon">
                        <i class="fas fa-fire"></i>
                    </div>
                    <div class="achievement-info">
                        <h4>First Streak</h4>
                        <p>Complete your first 7-day streak</p>
                        <span class="earned-date">Earned Dec 15, 2023</span>
                    </div>
                </div>
                
                <div class="achievement-card earned">
                    <div class="achievement-icon">
                        <i class="fas fa-medal"></i>
                    </div>
                    <div class="achievement-info">
                        <h4>Habit Master</h4>
                        <p>Maintain 5 habits simultaneously</p>
                        <span class="earned-date">Earned Dec 20, 2023</span>
                    </div>
                </div>
                
                <div class="achievement-card earned">
                    <div class="achievement-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="achievement-info">
                        <h4>Social Butterfly</h4>
                        <p>Connect with 5 friends</p>
                        <span class="earned-date">Earned Jan 2, 2024</span>
                    </div>
                </div>
                
                <div class="achievement-card">
                    <div class="achievement-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <div class="achievement-info">
                        <h4>Consistency King</h4>
                        <p>Maintain a 30-day streak</p>
                        <span class="progress-info">Progress: 23/30 days</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Handle profile form submission
    document.getElementById('profileForm').addEventListener('submit', handleProfileUpdate);
    
    // Handle notification toggles
    document.querySelectorAll('.toggle-switch input[type="checkbox"]').forEach(toggle => {
        toggle.addEventListener('change', handleNotificationToggle);
    });
    
    // Handle privacy settings
    document.querySelectorAll('.privacy-select').forEach(select => {
        select.addEventListener('change', handlePrivacyChange);
    });
    
    // Handle account actions
    document.getElementById('resetProgress').addEventListener('click', handleResetProgress);
    document.getElementById('deactivateAccount').addEventListener('click', handleDeactivateAccount);
    document.getElementById('deleteAccount').addEventListener('click', handleDeleteAccount);
    
    // Handle other buttons
    document.querySelector('.btn-change-password').addEventListener('click', handleChangePassword);
    document.querySelector('.btn-export-data').addEventListener('click', handleExportData);
    document.querySelector('.btn-change-avatar').addEventListener('click', handleChangeAvatar);
});

function handleProfileUpdate(e) {
    e.preventDefault();
    
    const formData = new FormData(e.target);
    const profileData = Object.fromEntries(formData);
    
    // Show loading state
    const button = document.querySelector('.btn-save-profile');
    const originalContent = button.innerHTML;
    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
    button.disabled = true;
    
    // Simulate API call
    setTimeout(() => {
        // Reset button
        button.innerHTML = originalContent;
        button.disabled = false;
        
        // Show success message
        showSuccessMessage('Profile updated successfully! ✨');
        
        console.log('Profile updated:', profileData);
    }, 1500);
}

function handleNotificationToggle() {
    const settingName = this.id;
    const isEnabled = this.checked;
    
    console.log(`${settingName} notifications:`, isEnabled ? 'enabled' : 'disabled');
    
    // Show subtle feedback
    showSuccessMessage(`${settingName.replace(/([A-Z])/g, ' $1').toLowerCase()} notifications ${isEnabled ? 'enabled' : 'disabled'}`);
}

function handlePrivacyChange() {
    const settingName = this.closest('.privacy-item').querySelector('h4').textContent;
    const value = this.value;
    
    console.log(`${settingName} privacy set to:`, value);
    
    showSuccessMessage(`${settingName} privacy updated to ${value}`);
}

function handleResetProgress() {
    if (confirm('Are you sure you want to reset all your habit progress? This action cannot be undone.')) {
        if (confirm('This will permanently delete all your habit data, streaks, and statistics. Are you absolutely sure?')) {
            // Simulate reset
            showSuccessMessage('Progress reset successfully. Starting fresh! 🌱');
            console.log('Progress reset');
        }
    }
}

function handleDeactivateAccount() {
    if (confirm('Are you sure you want to deactivate your account? You can reactivate it later by logging in.')) {
        // Simulate deactivation
        showSuccessMessage('Account deactivated. You can reactivate anytime by logging in.');
        console.log('Account deactivated');
    }
}

function handleDeleteAccount() {
    const confirmation = prompt('This action cannot be undone. Type "DELETE" to confirm account deletion:');
    
    if (confirmation === 'DELETE') {
        if (confirm('This will permanently delete your account and all associated data. Are you absolutely sure?')) {
            // Simulate deletion
            alert('Account deletion initiated. You will receive a confirmation email.');
            console.log('Account deletion requested');
        }
    } else if (confirmation !== null) {
        alert('Account deletion cancelled. Please type "DELETE" exactly to confirm.');
    }
}

function handleChangePassword() {
    // In a real app, this would open a password change modal or navigate to a secure page
    alert('Password change feature would be implemented here with proper security measures.');
}

function handleExportData() {
    // Show loading state
    const button = document.querySelector('.btn-export-data');
    const originalContent = button.innerHTML;
    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Preparing...';
    button.disabled = true;
    
    // Simulate data export preparation
    setTimeout(() => {
        // Reset button
        button.innerHTML = originalContent;
        button.disabled = false;
        
        // Simulate download
        showSuccessMessage('Data export prepared! Download will start shortly. 📊');
        
        console.log('Data export requested');
    }, 2000);
}

function handleChangeAvatar() {
    // In a real app, this would open a file picker or camera interface
    alert('Avatar change feature would open a file picker or camera interface here.');
}
</script>
{% endblock %}